from selenium import webdriver
import pandas as pd
import time

def crwaler_naeun( ) :

    input_cnt = int(input("원하는 키워드 입력 : "))
    input_keyword = []
    for i in range( input_cnt ) :
        input_keyword.append( input( "나은아, 오빠에게 키워드 제공 :" ) )
    
    naeun_list = []
    driver = webdriver.Chrome(executable_path='./chromedriver')
    
    for naeun in range( len(input_keyword) ) :
        url = "https://ad.search.naver.com/search.naver?where=ad&query={}".format( input_keyword[naeun] )
        driver.get(url = url)
        time.sleep(0.5)

        for i in range( 25 ) :
            try :
                naeun_list.append([ input_keyword[naeun], i+1, driver.find_element_by_css_selector("#content > div > ol > li:nth-child({}) > div.inner > div.url_area > a".format(i+1)).text ])
            except :
                pass

    marketer_naeun = pd.DataFrame( naeun_list, columns = ["검색어", "순위", "URL"] )
    marketer_naeun.to_excel( "./naeun_bot.xlsx", index = None )

    driver.close()

crwaler_naeun()
